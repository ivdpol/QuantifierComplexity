<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-04-16 Thu 17:47 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Languagegenerator documentation</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Paul Lodder" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">Languagegenerator documentation</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge08ffe5">1. Introduction</a></li>
<li><a href="#org1ce50d6">2. Representations</a>
<ul>
<li><a href="#org9a705dc">2.1. Expressions</a></li>
<li><a href="#org2192303">2.2. Models</a></li>
<li><a href="#orgc3c4632">2.3. Representing meanings of expressions</a>
<ul>
<li><a href="#orga06208b">2.3.1. Boolean expressions representation</a></li>
<li><a href="#org8e875b1">2.3.2. Int and float expression representation</a></li>
<li><a href="#org2ce5bdd">2.3.3. Set representations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org71d6677">3. Getting started</a></li>
<li><a href="#orga073d2e">4. How expressions are generated</a></li>
<li><a href="#orgd333e14">5. Scoring</a>
<ul>
<li><a href="#org89477f6">5.1. Signature functions</a></li>
<li><a href="#orgd88145c">5.2. Computing scores for the expressions</a></li>
<li><a href="#org81c9350">5.3. Visualizing results</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orge08ffe5" class="outline-2">
<h2 id="orge08ffe5"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
The main purpose of the <code>LanguageGenerator</code> class is to generate all
expressions up to a given length that are unique when evaluated on models up to
a given size. This file serves the purpose of documenting both how
<code>LanguageGenerator</code> achieves this conceptually, as well as its implementation.
</p>

<p>
The method that generates all the expressions up to a given length is
<code>generate_all_sentences</code>, which takes just the <code>max_expression_length</code> as an
argument: i.e. the length up to which expressions should be generated. There
are however a number of other parameters that determine the output of this
function. We define these parameters in a separate json file under
<a href="experimental_setups">experimental_setups/</a> and we tell the <code>LanguageGenerator</code> upon initialization
which <code>.json</code> file to look at.
</p>

<p>
An example of such a file is
</p>
<div class="org-src-container">
<pre class="src src-sh">cat experiment_setups/Logical_index.json
</pre>
</div>

<pre class="example">
{
    "name": "Logical_index",
    "number_of_subsets": 3,
    "operators": [
        "&gt;f",
        "&gt;",
        "&gt;=",
        "=",
        "/",
        "subset",
        "intersection",
        "union",
        "card",
        "diff",
        "+",
        "-",
        "and",
        "or",
        "not",
        "index"

    ]
}
</pre>

<p>
apart from the name of the experiment, there are two interesting parameters
here:
</p>

<dl class="org-dl">
<dt>operators</dt><dd>the names of the operators to be used in constructing the
expressions. These names match with operators defined in
<a href="src/operators.py">src/operators.py</a></dd>
<dt>number_of_subsets</dt><dd>either \(3\) or \(4\). Defines a restriction on the models
to be used. If \(3\), we only consider models where each element is either
part of A, B or both (so only \(A\), \(B\), or \(A \cap B\)). If \(4\), also
consider models where there can be elements that are not part of either
(so \(A\), \(B\), or \(A \cap B\), and \(M \setminus (A \cup B)\))</dd>
</dl>

<p>
So when initializing, we tell our LanguageGenerator which experiment setup to
use, by simply providing the name of the <code>.json</code> file:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">import</span> sys
sys.path.insert(0,<span style="color: #11948b;">'..'</span>)
<span style="color: #778c00; font-weight: bold;">from</span> src.languagegenerator <span style="color: #778c00; font-weight: bold;">import</span> LanguageGenerator

<span style="color: #007ec4;">lg</span> = LanguageGenerator(
<span style="background-color: #f4eedb;"> </span>   max_model_size=3, experiment_setup=<span style="color: #11948b;">"Logical_index"</span>,
)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">(subset A A)</td>
<td class="org-left">(subset A B)</td>
<td class="org-left">(subset B A)</td>
<td class="org-left">(subset B B)</td>
<td class="org-left">(&gt; 1 (card A))</td>
<td class="org-left">(&gt; 1 (card B))</td>
<td class="org-left">(&gt; 2 (card A))</td>
<td class="org-left">(&gt; 2 (card B))</td>
<td class="org-left">(&gt; 3 (card A))</td>
<td class="org-left">(&gt; 3 (card B))</td>
<td class="org-left">(&gt; (card A) 1)</td>
<td class="org-left">(&gt; (card A) 2)</td>
<td class="org-left">(&gt; (card B) 1)</td>
<td class="org-left">(&gt; (card B) 2)</td>
<td class="org-left">(= 1 (card A))</td>
<td class="org-left">(= 1 (card B))</td>
<td class="org-left">(= 2 (card A))</td>
<td class="org-left">(= 2 (card B))</td>
<td class="org-left">(not (subset A B))</td>
<td class="org-left">(not (subset B A))</td>
<td class="org-left">(&gt; (card A) (card B))</td>
<td class="org-left">(&gt; (card B) (card A))</td>
<td class="org-left">(&gt;= (card A) (card B))</td>
<td class="org-left">(&gt;= (card B) (card A))</td>
<td class="org-left">(= (card A) (card B))</td>
<td class="org-left">(subset A (diff A B))</td>
<td class="org-left">(subset A (index 0 B))</td>
<td class="org-left">(subset A (index 1 B))</td>
<td class="org-left">(subset A (index 2 B))</td>
<td class="org-left">(subset A (index 3 B))</td>
<td class="org-left">(subset B (diff B A))</td>
<td class="org-left">(subset B (index 0 A))</td>
<td class="org-left">(subset B (index 1 A))</td>
<td class="org-left">(subset B (index 2 A))</td>
<td class="org-left">(subset B (index 3 A))</td>
<td class="org-left">(subset (intersection A B) A)</td>
<td class="org-left">(subset (union A B) A)</td>
<td class="org-left">(subset (union A B) B)</td>
<td class="org-left">(subset (diff A B) A)</td>
<td class="org-left">(subset (diff B A) B)</td>
<td class="org-left">(subset (index 0 A) B)</td>
<td class="org-left">(subset (index 0 B) A)</td>
<td class="org-left">(subset (index 1 A) B)</td>
<td class="org-left">(subset (index 1 B) A)</td>
<td class="org-left">(subset (index 2 A) B)</td>
<td class="org-left">(subset (index 2 B) A)</td>
<td class="org-left">(subset (index 3 A) B)</td>
<td class="org-left">(subset (index 3 B) A)</td>
<td class="org-left">(not (= 1 (card A)))</td>
<td class="org-left">(not (= 1 (card B)))</td>
<td class="org-left">(not (= 2 (card A)))</td>
<td class="org-left">(not (= 2 (card B)))</td>
<td class="org-left">(&gt; 1 (card (intersection A B)))</td>
<td class="org-left">(&gt; 1 (card (index 0 A)))</td>
<td class="org-left">(&gt; 1 (card (index 0 B)))</td>
<td class="org-left">(&gt; 2 (card (intersection A B)))</td>
<td class="org-left">(&gt; 2 (card (union A B)))</td>
<td class="org-left">(&gt; 2 (card (diff A B)))</td>
<td class="org-left">(&gt; 2 (card (diff B A)))</td>
<td class="org-left">(&gt; 3 (card (intersection A B)))</td>
<td class="org-left">(&gt; 3 (card (union A B)))</td>
<td class="org-left">(&gt; 3 (card (diff A B)))</td>
<td class="org-left">(&gt; 3 (card (diff B A)))</td>
<td class="org-left">(&gt; (card (intersection A B)) 1)</td>
<td class="org-left">(&gt; (card (intersection A B)) 2)</td>
<td class="org-left">(&gt; (card (union A B)) 1)</td>
<td class="org-left">(&gt; (card (union A B)) 2)</td>
<td class="org-left">(&gt; (card (diff A B)) 1)</td>
<td class="org-left">(&gt; (card (diff A B)) 2)</td>
<td class="org-left">(&gt; (card (diff B A)) 1)</td>
<td class="org-left">(&gt; (card (diff B A)) 2)</td>
<td class="org-left">(= 1 (card (intersection A B)))</td>
<td class="org-left">(= 1 (card (diff A B)))</td>
<td class="org-left">(= 1 (card (diff B A)))</td>
<td class="org-left">(= 2 (card (intersection A B)))</td>
<td class="org-left">(= 2 (card (union A B)))</td>
<td class="org-left">(= 2 (card (diff A B)))</td>
<td class="org-left">(= 2 (card (diff B A)))</td>
<td class="org-left">(subset A (index (card B) A))</td>
<td class="org-left">(subset A (index (card B) B))</td>
<td class="org-left">(subset B (index (card A) A))</td>
<td class="org-left">(subset (index (card A) A) B)</td>
<td class="org-left">(subset (index (card A) B) A)</td>
<td class="org-left">(subset (index (card A) B) B)</td>
<td class="org-left">(subset (index (card B) A) A)</td>
<td class="org-left">(subset (index (card B) A) B)</td>
<td class="org-left">(subset (index (card B) B) A)</td>
<td class="org-left">(not (= (card A) (card B)))</td>
<td class="org-left">(not (subset A (diff A B)))</td>
<td class="org-left">(not (subset A (index 0 B)))</td>
<td class="org-left">(not (subset A (index 1 B)))</td>
<td class="org-left">(not (subset A (index 2 B)))</td>
<td class="org-left">(not (subset A (index 3 B)))</td>
<td class="org-left">(not (subset B (diff B A)))</td>
<td class="org-left">(not (subset B (index 0 A)))</td>
<td class="org-left">(not (subset B (index 1 A)))</td>
<td class="org-left">(not (subset B (index 2 A)))</td>
<td class="org-left">(not (subset B (index 3 A)))</td>
<td class="org-left">(not (subset (index 1 A) B))</td>
<td class="org-left">(not (subset (index 1 B) A))</td>
<td class="org-left">(not (subset (index 2 A) B))</td>
<td class="org-left">(not (subset (index 2 B) A))</td>
<td class="org-left">(not (subset (index 3 A) B))</td>
<td class="org-left">(not (subset (index 3 B) A))</td>
</tr>
</tbody>
</table>

<p>
Let us generate all expressions up to length 6:
</p>

<div class="org-src-container">
<pre class="src src-python">lg.generate_all_sentences(6)
</pre>
</div>

<p>
Now before going into how the LanguageGenerator generates unique expressions up
to a given length, let us describe how we represent models, expressions, and
meaning of expressions.
</p>
</div>
</div>

<div id="outline-container-org1ce50d6" class="outline-2">
<h2 id="org1ce50d6"><span class="section-number-2">2</span> Representations</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org9a705dc" class="outline-3">
<h3 id="org9a705dc"><span class="section-number-3">2.1</span> Expressions</h3>
<div class="outline-text-3" id="text-2-1">
<p>
We define expressions using tuples. See some examples:
</p>
<div class="org-src-container">
<pre class="src src-python">(<span style="color: #11948b;">"subset"</span>, <span style="color: #11948b;">"A"</span>, (<span style="color: #11948b;">"diff"</span>, <span style="color: #11948b;">"A"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"3"</span>, <span style="color: #11948b;">"B"</span>))),
(<span style="color: #11948b;">"="</span>, <span style="color: #11948b;">"3"</span>, (<span style="color: #11948b;">"card"</span>, (<span style="color: #11948b;">"union"</span>, <span style="color: #11948b;">"A"</span>, <span style="color: #11948b;">"B"</span>))),
(<span style="color: #11948b;">"&gt;"</span>, <span style="color: #11948b;">"6"</span>, (<span style="color: #11948b;">"+"</span>, (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"A"</span>), (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"B"</span>)))

(<span style="color: #11948b;">"+"</span>, (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"A"</span>), (<span style="color: #11948b;">"card"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"5"</span>, <span style="color: #11948b;">"A"</span>))),
(<span style="color: #11948b;">"card"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"5"</span>, (<span style="color: #11948b;">"union"</span>, <span style="color: #11948b;">"A"</span>, <span style="color: #11948b;">"B"</span>))),
(<span style="color: #11948b;">"+"</span>, <span style="color: #11948b;">"1"</span>, (<span style="color: #11948b;">"card"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"5"</span>, <span style="color: #11948b;">"A"</span>)))

(<span style="color: #11948b;">"/"</span>, (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"B"</span>), (<span style="color: #11948b;">"-"</span>, (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"B"</span>), <span style="color: #11948b;">"1"</span>))
(<span style="color: #11948b;">"/"</span>, (<span style="color: #11948b;">"+"</span>, <span style="color: #11948b;">"5"</span>, <span style="color: #11948b;">"6"</span>), (<span style="color: #11948b;">"+"</span>, <span style="color: #11948b;">"2"</span>, <span style="color: #11948b;">"6"</span>))
(<span style="color: #11948b;">"/"</span>, (<span style="color: #11948b;">"card"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"6"</span>, <span style="color: #11948b;">"B"</span>)), (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"A"</span>))

(<span style="color: #11948b;">"union"</span>, <span style="color: #11948b;">"B"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"4"</span>, <span style="color: #11948b;">"A"</span>)),
(<span style="color: #11948b;">"diff"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"4"</span>, <span style="color: #11948b;">"A"</span>), (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"6"</span>, <span style="color: #11948b;">"B"</span>)),
(<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"3"</span>, (<span style="color: #11948b;">"diff"</span>, <span style="color: #11948b;">"A"</span>, (<span style="color: #11948b;">"index"</span>, <span style="color: #11948b;">"1"</span>, <span style="color: #11948b;">"B"</span>)))
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">index</td>
<td class="org-right">3</td>
<td class="org-left">(diff A (index 1 B))</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org2192303" class="outline-3">
<h3 id="org2192303"><span class="section-number-3">2.2</span> Models</h3>
<div class="outline-text-3" id="text-2-2">
<p>
We represent models of size \(k\) here by a \(2\times k\) matrix, where the ith column
denotes the \(i^{th}\) object of the model. Each object then is represented by a
2-vector, where the first value is a 1 iff this object is in \(A\), and the
second element denotes membership of \(B\).
So for example<br />
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">0</td>
<td class="org-right">0</td>
</tr>
</tbody>
</table>
<p>
denotes a model where the first object is in \(A \cap B\), the second element is
in \(B \setminus A\), the third element is in \(A \setminus B\), and the last
element is in \(M \setminus (A\cup B)\).
</p>

<p>
We can equivalently represent models as a tuple of 2-tuples, where the ith
2-tuple contains the values in the \(i^{th}\) column of the matrix above. We call
this the <b>tuple format</b>.
</p>

<p>
We define the <b>universe up to n</b> to be an ordered tuple/list of all models up to a
size n, or simply the universe if \(n\) is clear from the context.
</p>
</div>
</div>

<div id="outline-container-orgc3c4632" class="outline-3">
<h3 id="orgc3c4632"><span class="section-number-3">2.3</span> Representing meanings of expressions</h3>
<div class="outline-text-3" id="text-2-3">
<p>
We use a dynamic programming approach to compute the meaning of new
expressions, where we combine the previously computed meanings of
sub-expressions. To this end, the meaning of every expression is stored. We
represent meanings of expressions in different ways, depending on the output
type of the expressions. We distinguish between <b>boolean</b> expressions, <b>int</b>,
<b>float</b> and <b>set</b>.
</p>
</div>

<div id="outline-container-orga06208b" class="outline-4">
<h4 id="orga06208b"><span class="section-number-4">2.3.1</span> Boolean expressions representation</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Boolean expressions are those that are either true or false on a given model.
If the universe up to \(n\) is of size \(m\), then we represent a boolean
expression \(e\) as a binary array of size \(m\), where the ith element is 1 iff
the expression \(e\) is true on the ith model in the universe.
</p>

<p>
So an example of the meaning of a boolean expression:
</p>
<div class="org-src-container">
<pre class="src src-python">lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">bool</span>][(<span style="color: #11948b;">'not'</span>, (<span style="color: #11948b;">'subset'</span>, <span style="color: #11948b;">'A'</span>, <span style="color: #11948b;">'B'</span>))]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">True</td>
<td class="org-left">False</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-org8e875b1" class="outline-4">
<h4 id="org8e875b1"><span class="section-number-4">2.3.2</span> Int and float expression representation</h4>
<div class="outline-text-4" id="text-2-3-2">
<p>
Expressions that evaluate to integers and floats are represented by an
array the size of the universe, and the \(i^{th}\) element denotes the value of
that expression for the \(i^{th}\) model:
</p>

<p>
Example of an integer meaning:
</p>
<div class="org-src-container">
<pre class="src src-python">lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">int</span>][(<span style="color: #11948b;">"+"</span>, (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"A"</span>), (<span style="color: #11948b;">"card"</span>, <span style="color: #11948b;">"B"</span>))]
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-org2ce5bdd" class="outline-4">
<h4 id="org2ce5bdd"><span class="section-number-4">2.3.3</span> Set representations</h4>
<div class="outline-text-4" id="text-2-3-3">
<p>
Representing the meaning of expressions that describe sets requires a
slightly more complicated approach. Let us look at some examples:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">for</span> models_of_size <span style="color: #778c00; font-weight: bold;">in</span> lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">set</span>][<span style="color: #11948b;">"A"</span>]:
<span style="background-color: #f4eedb;"> </span>   <span style="color: #778c00; font-weight: bold;">print</span>(models_of_size,<span style="color: #11948b;">'\n'</span>)
</pre>
</div>

<pre class="example">
[[0 1 1]]

[[0 0 0 1 1 1 1 1 1]
 [0 1 1 0 0 1 1 1 1]]

[[0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
 [0 0 0 1 1 1 1 1 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1]
 [0 1 1 0 0 1 1 1 1 0 0 1 1 1 1 0 0 0 0 1 1 1 1 1 1 1 1]]


</pre>

<p>
What we see above is 3 matrices, one for each model size. We represent A
here by setting the values to 1 that represent elements that belong to A.
Let us look at another example of B:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">for</span> models_of_size <span style="color: #778c00; font-weight: bold;">in</span> lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">set</span>][<span style="color: #11948b;">"B"</span>]:
<span style="background-color: #f4eedb;"> </span>   <span style="color: #778c00; font-weight: bold;">print</span>(models_of_size, <span style="color: #11948b;">"\n"</span>)
</pre>
</div>

<pre class="example">
[[1 0 1]]

[[1 1 1 0 1 0 0 1 1]
 [1 0 1 1 1 0 1 0 1]]

[[1 1 1 1 1 1 1 1 1 0 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1]
 [1 1 1 0 1 0 0 1 1 1 1 1 1 1 1 0 1 0 1 0 0 1 1 0 0 1 1]
 [1 0 1 1 1 0 1 0 1 1 1 0 1 0 1 1 1 1 1 0 1 0 1 0 1 0 1]]


</pre>

<p>
Now let us look at what the meaning of the expression \(A \cap B\) looks like:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">for</span> models_of_size <span style="color: #778c00; font-weight: bold;">in</span> lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">set</span>][
<span style="background-color: #f4eedb;"> </span>   (<span style="color: #11948b;">"intersection"</span>, <span style="color: #11948b;">"A"</span>, <span style="color: #11948b;">"B"</span>)
]:
<span style="background-color: #f4eedb;"> </span>   <span style="color: #778c00; font-weight: bold;">print</span>(models_of_size, <span style="color: #11948b;">"\n"</span>)
</pre>
</div>

<pre class="example">
[[0 0 1]]

[[0 0 0 0 1 0 0 1 1]
 [0 0 1 0 0 0 1 0 1]]

[[0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0 0 1 1 0 0 0 0 1 1 1 1]
 [0 0 0 0 1 0 0 1 1 0 0 0 0 0 0 0 1 0 1 0 0 1 1 0 0 1 1]
 [0 0 1 0 0 0 1 0 1 0 0 0 1 0 1 0 0 0 0 0 1 0 1 0 1 0 1]]


</pre>

<p>
We can see that representing the intersection of A and B corresponds to
preforming the element-wise AND operation on the set representations of A and
B. For the union, we have
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">for</span> models_of_size <span style="color: #778c00; font-weight: bold;">in</span> lg.output_type2expression2meaning[<span style="color: #596e76; font-weight: bold;">set</span>][
<span style="background-color: #f4eedb;"> </span>   (<span style="color: #11948b;">"union"</span>, <span style="color: #11948b;">"A"</span>, <span style="color: #11948b;">"B"</span>)
]:
<span style="background-color: #f4eedb;"> </span>   <span style="color: #778c00; font-weight: bold;">print</span>(models_of_size, <span style="color: #11948b;">"\n"</span>)
</pre>
</div>

<pre class="example">
[[1 1 1]]

[[1 1 1 1 1 1 1 1 1]
 [1 1 1 1 1 1 1 1 1]]

[[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
 [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
 [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]]


</pre>

<p>
exactly what we expected: all ones. This is because we only consider models
where every element is at part of at least one of A or B.
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org71d6677" class="outline-2">
<h2 id="org71d6677"><span class="section-number-2">3</span> Getting started</h2>
<div class="outline-text-2" id="text-3">
<p>
As shown above, we can use the <code>LanguageGenerator</code> by pointing it to the
experiment_setup json file to be used, and setting maximum model size:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">import</span> src
<span style="color: #778c00; font-weight: bold;">from</span> src.languagegenerator <span style="color: #778c00; font-weight: bold;">import</span> LanguageGenerator

<span style="color: #007ec4;">lg</span> = LanguageGenerator(max_model_size=3, experiment_setup=<span style="color: #11948b;">"Logical_index"</span>, )
</pre>
</div>

<pre class="example">
'org_babel_python_eoe'

</pre>
</div>
</div>

<div id="outline-container-orga073d2e" class="outline-2">
<h2 id="orga073d2e"><span class="section-number-2">4</span> How expressions are generated</h2>
<div class="outline-text-2" id="text-4">
<p>
We generate all expressions by starting with expressions of length 1, storing
their meanings, and then defining expressions of greater length by combining
previously formed sub-expressions. For each new expression, its meaning is
computed and only if its meaning is not the same as any previously formed
meaning, we store it as a new expression (which will be used in later
expressions as subexpressions again). The method that implements this
functionality is <code>generate_all_sentences</code>, which takes the length of the
expressions to be generated.
</p>

<p>
By default, the LanguageGenerator will store itself, and the expressions
generated for each length up to the given length in <code>.dill</code> format under the
<a href="results">results/</a> folder. The name of the folder in the results folder to be used is
uniquely identifying for the parameters that lead to generation of these
sentences, e.g. <code>results/Experiment=Logical_index-max_model_size=5/</code>..
</p>

<p>
Now let's see what all expressions up to length 4 look like
Let's see what all unique boolean expressions up to length 4 looks like:
</p>
<div class="org-src-container">
<pre class="src src-python">lg.generate_all_sentences(4)
</pre>
</div>

<pre class="example">
['True',
 'False',
 ('subset', 'A', 'A'),
 ('subset', 'A', 'B'),
 ('subset', 'B', 'A'),
 ('subset', 'B', 'B'),
 ('&gt;', '1', ('card', 'A')),
 ('&gt;', '1', ('card', 'B')),
 ('&gt;', '2', ('card', 'A')),
 ('&gt;', '2', ('card', 'B')),
 ('&gt;', '3', ('card', 'A')),
 ('&gt;', '3', ('card', 'B')),
 ('&gt;', ('card', 'A'), '1'),
 ('&gt;', ('card', 'A'), '2'),
 ('&gt;', ('card', 'B'), '1'),
 ('&gt;', ('card', 'B'), '2'),
 ('=', '1', ('card', 'A')),
 ('=', '1', ('card', 'B')),
 ('=', '2', ('card', 'A')),
 ('=', '2', ('card', 'B')),
 ('not', ('subset', 'A', 'B')),
 ('not', ('subset', 'B', 'A'))]
</pre>
</div>
</div>

<div id="outline-container-orgd333e14" class="outline-2">
<h2 id="orgd333e14"><span class="section-number-2">5</span> Scoring</h2>
<div class="outline-text-2" id="text-5">
<p>
The <code>LanguageGenerator</code> is also able to score the expressions it has generated
based on some custom-defined signature function. See <a href="score.pdf">score.pdf</a> for more
information on the scoring itself.
</p>

<p>
We define a <b>meaning matrix</b> to be a <code>pd.DataFrame</code> that is indexed by the unique
models in the universe, represented in tuple format, and where each column
corresponds to an expression:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">meaning_matrix</span> = lg.get_meaning_matrix()
meaning_matrix
</pre>
</div>

<pre class="example">
                          True  False  ...  (=, 1, (card, B))  (=, 1, (card, A))
((0, 1),)                    1      0  ...                  1                  0
((1, 0),)                    1      0  ...                  0                  1
((1, 1),)                    1      0  ...                  1                  1
((0, 1), (0, 1))             1      0  ...                  0                  0
((0, 1), (1, 0))             1      0  ...                  1                  1
((0, 1), (1, 1))             1      0  ...                  0                  1
((1, 0), (0, 1))             1      0  ...                  1                  1
((1, 1), (0, 1))             1      0  ...                  0                  1
((1, 0), (1, 0))             1      0  ...                  0                  0
((1, 0), (1, 1))             1      0  ...                  1                  0
((1, 1), (1, 0))             1      0  ...                  1                  0
((1, 1), (1, 1))             1      0  ...                  0                  0
((0, 1), (0, 1), (0, 1))     1      0  ...                  0                  0
((0, 1), (0, 1), (1, 0))     1      0  ...                  0                  1
((0, 1), (0, 1), (1, 1))     1      0  ...                  0                  1
((0, 1), (1, 0), (0, 1))     1      0  ...                  0                  1
((0, 1), (1, 1), (0, 1))     1      0  ...                  0                  1
((0, 1), (1, 0), (1, 0))     1      0  ...                  1                  0
((0, 1), (1, 0), (1, 1))     1      0  ...                  0                  0
((0, 1), (1, 1), (1, 0))     1      0  ...                  0                  0
((0, 1), (1, 1), (1, 1))     1      0  ...                  0                  0
((1, 0), (0, 1), (0, 1))     1      0  ...                  0                  1
((1, 1), (0, 1), (0, 1))     1      0  ...                  0                  1
((1, 0), (0, 1), (1, 0))     1      0  ...                  1                  0
((1, 0), (0, 1), (1, 1))     1      0  ...                  0                  0
((1, 1), (0, 1), (1, 0))     1      0  ...                  0                  0
((1, 1), (0, 1), (1, 1))     1      0  ...                  0                  0
((1, 0), (1, 0), (0, 1))     1      0  ...                  1                  0
((1, 0), (1, 1), (0, 1))     1      0  ...                  0                  0
((1, 1), (1, 0), (0, 1))     1      0  ...                  0                  0
((1, 1), (1, 1), (0, 1))     1      0  ...                  0                  0
((1, 0), (1, 0), (1, 0))     1      0  ...                  0                  0
((1, 0), (1, 0), (1, 1))     1      0  ...                  1                  0
((1, 0), (1, 1), (1, 0))     1      0  ...                  1                  0
((1, 0), (1, 1), (1, 1))     1      0  ...                  0                  0
((1, 1), (1, 0), (1, 0))     1      0  ...                  1                  0
((1, 1), (1, 0), (1, 1))     1      0  ...                  0                  0
((1, 1), (1, 1), (1, 0))     1      0  ...                  0                  0
((1, 1), (1, 1), (1, 1))     1      0  ...                  0                  0

[39 rows x 22 columns]
</pre>

<p>
The cell in position \(i \times j\) is 1 iff the \(j^{th}\) expression is true on the \(i^{th}\)
model.
</p>
</div>

<div id="outline-container-org89477f6" class="outline-3">
<h3 id="org89477f6"><span class="section-number-3">5.1</span> Signature functions</h3>
<div class="outline-text-3" id="text-5-1">
<p>
We defined signature functions for graded measures of monotonicity,
quantity, and conserativity in <a href="src/signature_functions.py">src/signature_functions.py</a>. As discussed in
<a href="score.pdf">score.pdf</a>, signature functions induce partitions on the meaning matrix. Our
implementation of signature functions only take the meaning matrix, and
return the induced partition.
</p>

<p>
We distinguish between expression-invariant signature functions and
<b>expression-sensitive signature functions</b>:
</p>

<p>
A signature function is <b>expression-invariant</b> if it purely a function of
the models itself. A signature function is <b>expression-sensitive</b>, on the
other hand, if it's value for a particular model is expression-specific.
</p>

<p>
For instance, the signature function for quantity is expression-invariant:
it simply maps each model to a tuple with information on the cardinalities
of the relevant subsets of that model (\(|A|\), \(|B|\), \(|A \cap B|\), \(M \setminus (A \cup
   B)\)). Therefore, the results of the quantity signature look like:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">from</span> src <span style="color: #778c00; font-weight: bold;">import</span> signature_functions

<span style="color: #007ec4;">signature_quantity_output</span> = signature_functions.signature_quantity(
<span style="background-color: #f4eedb;"> </span>   meaning_matrix
)
signature_quantity_output
</pre>
</div>

<pre class="example">
((0, 1),)                   (0, 0, 1, 0)
((1, 0),)                   (0, 1, 0, 0)
((1, 1),)                   (1, 0, 0, 0)
((0, 1), (0, 1))            (0, 0, 2, 0)
((0, 1), (1, 0))            (0, 1, 1, 0)
((0, 1), (1, 1))            (1, 0, 1, 0)
((1, 0), (0, 1))            (0, 1, 1, 0)
((1, 1), (0, 1))            (1, 0, 1, 0)
((1, 0), (1, 0))            (0, 2, 0, 0)
((1, 0), (1, 1))            (1, 1, 0, 0)
((1, 1), (1, 0))            (1, 1, 0, 0)
((1, 1), (1, 1))            (2, 0, 0, 0)
((0, 1), (0, 1), (0, 1))    (0, 0, 3, 0)
((0, 1), (0, 1), (1, 0))    (0, 1, 2, 0)
((0, 1), (0, 1), (1, 1))    (1, 0, 2, 0)
((0, 1), (1, 0), (0, 1))    (0, 1, 2, 0)
((0, 1), (1, 1), (0, 1))    (1, 0, 2, 0)
((0, 1), (1, 0), (1, 0))    (0, 2, 1, 0)
((0, 1), (1, 0), (1, 1))    (1, 1, 1, 0)
((0, 1), (1, 1), (1, 0))    (1, 1, 1, 0)
((0, 1), (1, 1), (1, 1))    (2, 0, 1, 0)
((1, 0), (0, 1), (0, 1))    (0, 1, 2, 0)
((1, 1), (0, 1), (0, 1))    (1, 0, 2, 0)
((1, 0), (0, 1), (1, 0))    (0, 2, 1, 0)
((1, 0), (0, 1), (1, 1))    (1, 1, 1, 0)
((1, 1), (0, 1), (1, 0))    (1, 1, 1, 0)
((1, 1), (0, 1), (1, 1))    (2, 0, 1, 0)
((1, 0), (1, 0), (0, 1))    (0, 2, 1, 0)
((1, 0), (1, 1), (0, 1))    (1, 1, 1, 0)
((1, 1), (1, 0), (0, 1))    (1, 1, 1, 0)
((1, 1), (1, 1), (0, 1))    (2, 0, 1, 0)
((1, 0), (1, 0), (1, 0))    (0, 3, 0, 0)
((1, 0), (1, 0), (1, 1))    (1, 2, 0, 0)
((1, 0), (1, 1), (1, 0))    (1, 2, 0, 0)
((1, 0), (1, 1), (1, 1))    (2, 1, 0, 0)
((1, 1), (1, 0), (1, 0))    (1, 2, 0, 0)
((1, 1), (1, 0), (1, 1))    (2, 1, 0, 0)
((1, 1), (1, 1), (1, 0))    (2, 1, 0, 0)
((1, 1), (1, 1), (1, 1))    (3, 0, 0, 0)
dtype: object
</pre>

<p>
The signature function for monotonicity, however, is expression-sensitive,
as it depends on the presence of a submodel that satisfies the expression.
The output of this signature function is therefore of the same shape as the
meaning matrix:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">signature_monotonicity_output</span> = signature_functions.signature_monotonicity(
<span style="background-color: #f4eedb;"> </span>   meaning_matrix
)
signature_monotonicity_output
</pre>
</div>

<pre class="example">
                          True  False  ...  (=, 1, (card, B))  (=, 1, (card, A))
((0, 1),)                 True  False  ...               True              False
((1, 0),)                 True  False  ...               True               True
((1, 1),)                 True  False  ...               True               True
((0, 1), (0, 1))          True  False  ...               True              False
((0, 1), (1, 0))          True  False  ...               True               True
((0, 1), (1, 1))          True  False  ...               True               True
((1, 0), (0, 1))          True  False  ...               True               True
((1, 1), (0, 1))          True  False  ...               True               True
((1, 0), (1, 0))          True  False  ...               True              False
((1, 0), (1, 1))          True  False  ...               True              False
((1, 1), (1, 0))          True  False  ...               True              False
((1, 1), (1, 1))          True  False  ...               True              False
((0, 1), (0, 1), (0, 1))  True  False  ...               True              False
((0, 1), (0, 1), (1, 0))  True  False  ...               True               True
((0, 1), (0, 1), (1, 1))  True  False  ...               True               True
((0, 1), (1, 0), (0, 1))  True  False  ...               True               True
((0, 1), (1, 1), (0, 1))  True  False  ...               True               True
((0, 1), (1, 0), (1, 0))  True  False  ...               True              False
((0, 1), (1, 0), (1, 1))  True  False  ...               True              False
((0, 1), (1, 1), (1, 0))  True  False  ...               True              False
((0, 1), (1, 1), (1, 1))  True  False  ...               True              False
((1, 0), (0, 1), (0, 1))  True  False  ...               True               True
((1, 1), (0, 1), (0, 1))  True  False  ...               True               True
((1, 0), (0, 1), (1, 0))  True  False  ...               True              False
((1, 0), (0, 1), (1, 1))  True  False  ...               True              False
((1, 1), (0, 1), (1, 0))  True  False  ...               True              False
((1, 1), (0, 1), (1, 1))  True  False  ...               True              False
((1, 0), (1, 0), (0, 1))  True  False  ...               True              False
((1, 0), (1, 1), (0, 1))  True  False  ...               True              False
((1, 1), (1, 0), (0, 1))  True  False  ...               True              False
((1, 1), (1, 1), (0, 1))  True  False  ...               True              False
((1, 0), (1, 0), (1, 0))  True  False  ...              False              False
((1, 0), (1, 0), (1, 1))  True  False  ...               True              False
((1, 0), (1, 1), (1, 0))  True  False  ...               True              False
((1, 0), (1, 1), (1, 1))  True  False  ...               True              False
((1, 1), (1, 0), (1, 0))  True  False  ...               True              False
((1, 1), (1, 0), (1, 1))  True  False  ...               True              False
((1, 1), (1, 1), (1, 0))  True  False  ...               True              False
((1, 1), (1, 1), (1, 1))  True  False  ...               True              False

[39 rows x 22 columns]
</pre>

<p>
A cell in position \(i \times j\) is True iff the \(i^{th}\) model has a submodel that
satisfies the \(j^{th}\) expression.
</p>
</div>
</div>


<div id="outline-container-orgd88145c" class="outline-3">
<h3 id="orgd88145c"><span class="section-number-3">5.2</span> Computing scores for the expressions</h3>
<div class="outline-text-3" id="text-5-2">
<p>
So while the signature function computes the induced partition, the
<code>LanguageGenerator.get_exp2score</code> method implements the computation of the
reduction of entropy that the provided signature function provides with
respect to knowing if a model satisfies a given expression or not. Again,
see <a href="score.pdf">score.pdf</a> for more information on how this is computed.
</p>

<p>
The output of <code>LanguageGenerator.get_exp2score</code> is a <code>pd.Series</code> that is
indexed by expressions, and maps each expression to its score:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">exp2score_monotonicity</span> = lg.get_exp2score(
<span style="background-color: #f4eedb;"> </span>   signature_functions.signature_monotonicity
)
exp2score_monotonicity
</pre>
</div>

<pre class="example">
True                     1.000000
False                    1.000000
(subset, B, B)           0.259171
(subset, B, A)           0.260862
(subset, A, B)           1.000000
(subset, A, A)           1.000000
(not, (subset, B, A))    0.000000
(not, (subset, A, B))    0.000000
(&gt;, (card, B), 2)        0.516886
(&gt;, (card, B), 1)        0.362747
(&gt;, (card, A), 2)        1.000000
(&gt;, (card, A), 1)        1.000000
(&gt;, 3, (card, B))        0.000000
(&gt;, 3, (card, A))        1.000000
(&gt;, 2, (card, B))        0.000000
(&gt;, 2, (card, A))        1.000000
(&gt;, 1, (card, B))        0.023665
(&gt;, 1, (card, A))        1.000000
(=, 2, (card, B))        0.186723
(=, 2, (card, A))        1.000000
(=, 1, (card, B))        0.015518
(=, 1, (card, A))        1.000000
dtype: float64
</pre>


<p>
And for conservativity:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">exp2score_conservativity</span> = lg.get_exp2score(
<span style="background-color: #f4eedb;"> </span>   signature_functions.signature_conservativity
)
exp2score_conservativity
</pre>
</div>

<pre class="example">
True                     1.000000
False                    1.000000
(subset, B, B)           0.531720
(subset, B, A)           0.592618
(subset, A, B)           1.000000
(subset, A, A)           1.000000
(not, (subset, B, A))    0.592618
(not, (subset, A, B))    1.000000
(&gt;, (card, B), 2)        0.579694
(&gt;, (card, B), 1)        0.489300
(&gt;, (card, A), 2)        1.000000
(&gt;, (card, A), 1)        1.000000
(&gt;, 3, (card, B))        0.579694
(&gt;, 3, (card, A))        1.000000
(&gt;, 2, (card, B))        0.489300
(&gt;, 2, (card, A))        1.000000
(&gt;, 1, (card, B))        0.531720
(&gt;, 1, (card, A))        1.000000
(=, 2, (card, B))        0.369893
(=, 2, (card, A))        1.000000
(=, 1, (card, B))        0.369402
(=, 1, (card, A))        1.000000
dtype: float64
</pre>

<p>
Considering none of these expressions contain the index operator, we already
know that all the quantity scores are going to be 1:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">exp2score_quantity</span> = lg.get_exp2score(signature_functions.signature_quantity)
exp2score_quantity
</pre>
</div>

<pre class="example">
True                     1.0
False                    1.0
(subset, B, B)           1.0
(subset, B, A)           1.0
(subset, A, B)           1.0
(subset, A, A)           1.0
(not, (subset, B, A))    1.0
(not, (subset, A, B))    1.0
(&gt;, (card, B), 2)        1.0
(&gt;, (card, B), 1)        1.0
(&gt;, (card, A), 2)        1.0
(&gt;, (card, A), 1)        1.0
(&gt;, 3, (card, B))        1.0
(&gt;, 3, (card, A))        1.0
(&gt;, 2, (card, B))        1.0
(&gt;, 2, (card, A))        1.0
(&gt;, 1, (card, B))        1.0
(&gt;, 1, (card, A))        1.0
(=, 2, (card, B))        1.0
(=, 2, (card, A))        1.0
(=, 1, (card, B))        1.0
(=, 1, (card, A))        1.0
dtype: float64
</pre>
</div>
</div>

<div id="outline-container-org81c9350" class="outline-3">
<h3 id="org81c9350"><span class="section-number-3">5.3</span> Visualizing results</h3>
<div class="outline-text-3" id="text-5-3">
<p>
In addition to computing the scores, the <code>LanguageGenerator</code> also implements
visualizing the resulting scores as <code>.png</code> or as rotating <code>.gif</code> (in case of
3 scores).
</p>

<p>
Let's first compute expressions up to a greater length so that we can see
some spread in the quantity scores as well.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">import</span> os

<span style="color: #007ec4;">lg</span> = LanguageGenerator(
<span style="background-color: #f4eedb;"> </span>   max_model_size=3, experiment_setup=<span style="color: #11948b;">"Logical_index"</span>,
)
lg.generate_all_sentences(6)
</pre>
</div>

<pre class="example">
['True',
 'False',
 ('subset', 'A', 'A'),
 ('subset', 'A', 'B'),
 ('subset', 'B', 'A'),
 ('subset', 'B', 'B'),
 ('&gt;', '1', ('card', 'A')),
 ('&gt;', '1', ('card', 'B')),
 ('&gt;', '2', ('card', 'A')),
 ('&gt;', '2', ('card', 'B')),
 ('&gt;', '3', ('card', 'A')),
 ('&gt;', '3', ('card', 'B')),
 ('&gt;', ('card', 'A'), '1'),
 ('&gt;', ('card', 'A'), '2'),
 ('&gt;', ('card', 'B'), '1'),
 ('&gt;', ('card', 'B'), '2'),
 ('=', '1', ('card', 'A')),
 ('=', '1', ('card', 'B')),
 ('=', '2', ('card', 'A')),
 ('=', '2', ('card', 'B')),
 ('not', ('subset', 'A', 'B')),
 ('not', ('subset', 'B', 'A')),
 ('&gt;', ('card', 'A'), ('card', 'B')),
 ('&gt;', ('card', 'B'), ('card', 'A')),
 ('&gt;=', ('card', 'A'), ('card', 'B')),
 ('&gt;=', ('card', 'B'), ('card', 'A')),
 ('=', ('card', 'A'), ('card', 'B')),
 ('subset', 'A', ('diff', 'A', 'B')),
 ('subset', 'A', ('index', '0', 'B')),
 ('subset', 'A', ('index', '1', 'B')),
 ('subset', 'A', ('index', '2', 'B')),
 ('subset', 'A', ('index', '3', 'B')),
 ('subset', 'B', ('diff', 'B', 'A')),
 ('subset', 'B', ('index', '0', 'A')),
 ('subset', 'B', ('index', '1', 'A')),
 ('subset', 'B', ('index', '2', 'A')),
 ('subset', 'B', ('index', '3', 'A')),
 ('subset', ('intersection', 'A', 'B'), 'A'),
 ('subset', ('union', 'A', 'B'), 'A'),
 ('subset', ('union', 'A', 'B'), 'B'),
 ('subset', ('diff', 'A', 'B'), 'A'),
 ('subset', ('diff', 'B', 'A'), 'B'),
 ('subset', ('index', '0', 'A'), 'B'),
 ('subset', ('index', '0', 'B'), 'A'),
 ('subset', ('index', '1', 'A'), 'B'),
 ('subset', ('index', '1', 'B'), 'A'),
 ('subset', ('index', '2', 'A'), 'B'),
 ('subset', ('index', '2', 'B'), 'A'),
 ('subset', ('index', '3', 'A'), 'B'),
 ('subset', ('index', '3', 'B'), 'A'),
 ('not', ('=', '1', ('card', 'A'))),
 ('not', ('=', '1', ('card', 'B'))),
 ('not', ('=', '2', ('card', 'A'))),
 ('not', ('=', '2', ('card', 'B'))),
 ('&gt;', '1', ('card', ('intersection', 'A', 'B'))),
 ('&gt;', '1', ('card', ('index', '0', 'A'))),
 ('&gt;', '1', ('card', ('index', '0', 'B'))),
 ('&gt;', '2', ('card', ('intersection', 'A', 'B'))),
 ('&gt;', '2', ('card', ('union', 'A', 'B'))),
 ('&gt;', '2', ('card', ('diff', 'A', 'B'))),
 ('&gt;', '2', ('card', ('diff', 'B', 'A'))),
 ('&gt;', '3', ('card', ('intersection', 'A', 'B'))),
 ('&gt;', '3', ('card', ('union', 'A', 'B'))),
 ('&gt;', '3', ('card', ('diff', 'A', 'B'))),
 ('&gt;', '3', ('card', ('diff', 'B', 'A'))),
 ('&gt;', ('card', ('intersection', 'A', 'B')), '1'),
 ('&gt;', ('card', ('intersection', 'A', 'B')), '2'),
 ('&gt;', ('card', ('union', 'A', 'B')), '1'),
 ('&gt;', ('card', ('union', 'A', 'B')), '2'),
 ('&gt;', ('card', ('diff', 'A', 'B')), '1'),
 ('&gt;', ('card', ('diff', 'A', 'B')), '2'),
 ('&gt;', ('card', ('diff', 'B', 'A')), '1'),
 ('&gt;', ('card', ('diff', 'B', 'A')), '2'),
 ('=', '1', ('card', ('intersection', 'A', 'B'))),
 ('=', '1', ('card', ('diff', 'A', 'B'))),
 ('=', '1', ('card', ('diff', 'B', 'A'))),
 ('=', '2', ('card', ('intersection', 'A', 'B'))),
 ('=', '2', ('card', ('union', 'A', 'B'))),
 ('=', '2', ('card', ('diff', 'A', 'B'))),
 ('=', '2', ('card', ('diff', 'B', 'A'))),
 ('subset', 'A', ('index', ('card', 'B'), 'A')),
 ('subset', 'A', ('index', ('card', 'B'), 'B')),
 ('subset', 'B', ('index', ('card', 'A'), 'A')),
 ('subset', ('index', ('card', 'A'), 'A'), 'B'),
 ('subset', ('index', ('card', 'A'), 'B'), 'A'),
 ('subset', ('index', ('card', 'A'), 'B'), 'B'),
 ('subset', ('index', ('card', 'B'), 'A'), 'A'),
 ('subset', ('index', ('card', 'B'), 'A'), 'B'),
 ('subset', ('index', ('card', 'B'), 'B'), 'A'),
 ('not', ('=', ('card', 'A'), ('card', 'B'))),
 ('not', ('subset', 'A', ('diff', 'A', 'B'))),
 ('not', ('subset', 'A', ('index', '0', 'B'))),
 ('not', ('subset', 'A', ('index', '1', 'B'))),
 ('not', ('subset', 'A', ('index', '2', 'B'))),
 ('not', ('subset', 'A', ('index', '3', 'B'))),
 ('not', ('subset', 'B', ('diff', 'B', 'A'))),
 ('not', ('subset', 'B', ('index', '0', 'A'))),
 ('not', ('subset', 'B', ('index', '1', 'A'))),
 ('not', ('subset', 'B', ('index', '2', 'A'))),
 ('not', ('subset', 'B', ('index', '3', 'A'))),
 ('not', ('subset', ('index', '1', 'A'), 'B')),
 ('not', ('subset', ('index', '1', 'B'), 'A')),
 ('not', ('subset', ('index', '2', 'A'), 'B')),
 ('not', ('subset', ('index', '2', 'B'), 'A')),
 ('not', ('subset', ('index', '3', 'A'), 'B')),
 ('not', ('subset', ('index', '3', 'B'), 'A'))]
</pre>


<p>
Now if we want to produce a 2d scatter plot showing the conservativity vs.
monotonicity, we do:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #007ec4;">full_outpath</span> = lg.plot_png(
<span style="background-color: #f4eedb;"> </span>   [
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_conservativity,
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_monotonicity,
<span style="background-color: #f4eedb;"> </span>   ],
)

full_outpath.relative_to(os.getcwd())
</pre>
</div>

<p>
Of if we want to produce a 3d scatter plot:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #778c00; font-weight: bold;">import</span> os

lg.plot_png(
<span style="background-color: #f4eedb;"> </span>   [
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_conservativity,
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_monotonicity,
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_quantity,
<span style="background-color: #f4eedb;"> </span>   ],
)
</pre>
</div>


<div class="figure">
<p><img src="file:///home/paul/projects/quantifiers/lot/results/Experiment=Logical_index-max_model_size=3/figures/conservativity-vs-monotonicity-vs-quantity.png" alt="conservativity-vs-monotonicity-vs-quantity.png" />
</p>
</div>

<p>
In addition, it is possible to produce 3d scatter gifs:
</p>
<div class="org-src-container">
<pre class="src src-python">lg.plot_gif(
<span style="background-color: #f4eedb;"> </span>   [
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_conservativity,
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_monotonicity,
<span style="background-color: #f4eedb;"> </span>   <span style="background-color: #f4eedb;"> </span>   signature_functions.signature_quantity,
<span style="background-color: #f4eedb;"> </span>   ],
<span style="background-color: #f4eedb;"> </span>   angle_shift_per_frame=1,
<span style="background-color: #f4eedb;"> </span>   frame_rate=1 / 24,
)
</pre>
</div>


<div class="figure">
<p><img src="file:///home/paul/projects/quantifiers/lot/results/Experiment=Logical_index-max_model_size=3/figures/conservativity-monotonicity-quantity-angle_shift=1-fr=0.042.gif" alt="conservativity-monotonicity-quantity-angle_shift=1-fr=0.042.gif" />
</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: April 14, 2020</p>
<p class="author">Author: Paul Lodder</p>
<p class="date">Created: 2020-04-16 Thu 17:47</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
